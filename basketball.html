<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊäïÁ±ÉÈÅäÊà≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #333;
        }

        .container {
            background: #fff;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .scoreboard {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .score-item {
            display: inline-block;
            margin: 0 20px;
        }

        .score-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .score-value {
            font-size: 2em;
            font-weight: bold;
        }

        .game-area {
            position: relative;
            width: 100%;
            height: 400px;
            background: linear-gradient(to bottom, #87CEEB 0%, #E0F6FF 100%);
            border-radius: 15px;
            border: 3px solid #333;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .hoop-post {
            position: absolute;
            right: 30px;
            bottom: 0;
            width: 8px;
            height: 200px;
            background: #8B4513;
            border-radius: 4px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.3);
        }

        .backboard {
            position: absolute;
            right: 20px;
            top: 60px;
            width: 12px;
            height: 120px;
            background: #FFD700;
            border: 2px solid #333;
            border-radius: 2px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        }

        .rim {
            position: absolute;
            right: 30px;
            top: 180px;
            width: 60px;
            height: 8px;
            background: #FF6347;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            z-index: 5;
        }

        .net {
            position: absolute;
            right: 24px;
            top: 190px;
            width: 72px;
            height: 80px;
            border-left: 2px solid #fff;
            border-right: 2px solid #fff;
            border-bottom: 2px solid #fff;
            border-radius: 0 0 50% 50%;
            opacity: 0.6;
            z-index: 3;
        }

        .ball {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle at 30% 30%, #FF8C00, #FF6347);
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), inset -2px -2px 4px rgba(0, 0, 0, 0.2);
            z-index: 10;
            left: 20px;
            top: 50px;
        }

        .controls {
            margin-bottom: 20px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .power-bar-container {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid #333;
            position: relative;
        }

        .power-bar {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50 0%, #FFC107 50%, #FF5722 100%);
            width: 0%;
            transition: width 0.05s;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 5px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .angle-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .angle-slider {
            flex: 1;
            height: 8px;
            border-radius: 4px;
            background: #e0e0e0;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .angle-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .angle-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .angle-value {
            min-width: 60px;
            text-align: right;
            font-weight: bold;
            color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        button {
            flex: 1;
            padding: 15px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .shoot-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .shoot-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .shoot-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .shoot-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .reset-btn {
            background: #FF6347;
            color: white;
        }

        .reset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 99, 71, 0.3);
        }

        .difficulty-selector {
            display: flex;
            gap: 10px;
        }

        .difficulty-btn {
            flex: 1;
            padding: 10px;
            background: #e0e0e0;
            border: 2px solid #999;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .difficulty-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .difficulty-btn:hover {
            transform: translateY(-2px);
        }

        .message {
            text-align: center;
            min-height: 30px;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .message.fail {
            color: #FF6347;
        }

        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .stat-item {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            color: #666;
            margin-bottom: 3px;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .wind-indicator {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÄ ÊäïÁ±ÉÈÅäÊà≤</h1>
        </div>

        <div class="scoreboard">
            <div class="score-item">
                <div class="score-label">ÂæóÂàÜ</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="score-item">
                <div class="score-label">ÊäïÁ±ÉÊï∏</div>
                <div class="score-value" id="attempts">0</div>
            </div>
        </div>

        <div class="message" id="message"></div>

        <div class="control-group">
            <label class="label">Èõ£Â∫¶ÈÅ∏Êìá</label>
            <div class="difficulty-selector">
                <button class="difficulty-btn active" data-difficulty="easy">Á∞°ÂñÆ</button>
                <button class="difficulty-btn" data-difficulty="normal">ÊôÆÈÄö</button>
                <button class="difficulty-btn" data-difficulty="hard">Âõ∞Èõ£</button>
            </div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-label">ÂëΩ‰∏≠Áéá</div>
                <div class="stat-value" id="accuracy">0%</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">ÈÄ£Á∫åÂæóÂàÜ</div>
                <div class="stat-value" id="streak">0</div>
            </div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="wind-indicator" id="windIndicator">È¢®: ÁÑ°</div>
            <div class="backboard"></div>
            <div class="hoop-post"></div>
            <div class="rim"></div>
            <div class="net"></div>
            <div class="ball" id="ball"></div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label class="label">ÊäïÁ±ÉËßíÂ∫¶</label>
                <div class="angle-container">
                    <input type="range" id="angleSlider" class="angle-slider" min="20" max="80" value="45">
                    <span class="angle-value" id="angleValue">45¬∞</span>
                </div>
            </div>

            <div class="control-group">
                <label class="label">ÊäïÁ±ÉÂäõÈÅì</label>
                <div class="power-bar-container">
                    <div class="power-bar" id="powerBar">
                        <span id="powerPercent">0%</span>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="shoot-btn" id="shootBtn">ÊäïÁ±É (Á©∫ÁôΩÈçµ)</button>
                <button class="reset-btn" id="resetBtn">ÈáçÊñ∞ÈñãÂßã</button>
            </div>
        </div>
    </div>

    <script>
        // ÈÅäÊà≤ÁãÄÊÖã
        const game = {
            score: 0,
            attempts: 0,
            hits: 0,
            streak: 0,
            power: 0,
            angle: 45,
            difficulty: 'normal',
            isThrown: false,
            wind: 0,
            windDirection: 1,
            ballX: 20,
            ballY: 50,
            ballVX: 0,
            ballVY: 0,
            ballRadius: 10,
            gravity: 0.3,
            friction: 0.98,
            bounceDamping: 0.7,
            maxBounceDamping: 0.9
        };

        const elements = {
            ball: document.getElementById('ball'),
            score: document.getElementById('score'),
            attempts: document.getElementById('attempts'),
            message: document.getElementById('message'),
            powerBar: document.getElementById('powerBar'),
            powerPercent: document.getElementById('powerPercent'),
            angleSlider: document.getElementById('angleSlider'),
            angleValue: document.getElementById('angleValue'),
            shootBtn: document.getElementById('shootBtn'),
            resetBtn: document.getElementById('resetBtn'),
            gameArea: document.getElementById('gameArea'),
            accuracy: document.getElementById('accuracy'),
            streak: document.getElementById('streak'),
            windIndicator: document.getElementById('windIndicator')
        };

        // ÈÅäÊà≤ÂçÄÂüüÂ∞∫ÂØ∏
        const gameAreaRect = {
            width: elements.gameArea.offsetWidth,
            height: elements.gameArea.offsetHeight
        };

        // Á±ÉÊ°Ü‰ΩçÁΩÆ
        const hoopPosition = {
            x: gameAreaRect.width - 60,
            y: 188,
            radius: 30,
            width: 60,
            height: 8
        };

        // ËÉåÊùø‰ΩçÁΩÆ
        const backboardPosition = {
            x: gameAreaRect.width - 16,
            y: 60,
            width: 12,
            height: 120
        };

        // Èõ£Â∫¶Ë®≠ÂÆö
        const difficulties = {
            easy: {
                initialPower: 50,
                speedMultiplier: 0.8,
                windStrength: 0.3,
                holeSize: 1.3
            },
            normal: {
                initialPower: 30,
                speedMultiplier: 1,
                windStrength: 0.6,
                holeSize: 1
            },
            hard: {
                initialPower: 20,
                speedMultiplier: 1.2,
                windStrength: 1,
                holeSize: 0.8
            }
        };

        // Êõ¥Êñ∞ËßíÂ∫¶È°ØÁ§∫
        elements.angleSlider.addEventListener('input', (e) => {
            game.angle = parseInt(e.target.value);
            elements.angleValue.textContent = game.angle + '¬∞';
        });

        // Èõ£Â∫¶ÊåâÈàï
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                game.difficulty = btn.dataset.difficulty;
                clearMessage();
            });
        });

        // ÊäïÁ±ÉÊåâÈàï
        elements.shootBtn.addEventListener('click', shoot);
        elements.resetBtn.addEventListener('click', reset);

        // Á©∫ÁôΩÈçµÊéßÂà∂ÊäïÁ±É
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                shoot();
            }
        });

        // ÈõªÊ∫êÊ¢ùÂãïÁï´
        function startPowerBar() {
            game.power = 0;
            elements.shootBtn.disabled = true;
            elements.angleSlider.disabled = true;

            const interval = setInterval(() => {
                game.power += 3;
                if (game.power > 100) {
                    game.power = 100;
                }

                updatePowerBar();

                if (game.power >= 100) {
                    clearInterval(interval);
                    game.power = 0;
                    // Ëá™ÂãïÈñãÂßãÈáçË§á
                    setTimeout(() => startPowerBar(), 300);
                }
            }, 20);
        }

        // Êõ¥Êñ∞ÈõªÊ∫êÊ¢ù
        function updatePowerBar() {
            elements.powerBar.style.width = game.power + '%';
            elements.powerPercent.textContent = game.power + '%';
        }

        // ÊäïÁ±É
        function shoot() {
            if (game.isThrown) return;

            if (game.power === 0) {
                startPowerBar();
                return;
            }

            elements.shootBtn.disabled = false;
            elements.angleSlider.disabled = false;

            game.isThrown = true;
            game.attempts++;

            const angleRad = (game.angle * Math.PI) / 180;
            const difficulty = difficulties[game.difficulty];
            const power = (game.power / 100) * difficulty.initialPower * difficulty.speedMultiplier;

            game.ballVX = Math.cos(angleRad) * power + game.wind;
            game.ballVY = -Math.sin(angleRad) * power;

            updateUI();
            gameLoop();
        }

        // ÈÅäÊà≤Âæ™Áí∞
        function gameLoop() {
            if (!game.isThrown) return;

            // ÊáâÁî®ÈáçÂäõ
            game.ballVY += game.gravity;

            // ÊáâÁî®È¢®
            game.wind += (Math.random() - 0.5) * 0.2;
            game.wind = Math.max(-2, Math.min(2, game.wind));
            game.ballVX += game.wind * 0.01;

            // ÊáâÁî®Êë©Êì¶Âäõ
            game.ballVX *= game.friction;
            game.ballVY *= game.friction;

            // Êõ¥Êñ∞‰ΩçÁΩÆ
            game.ballX += game.ballVX;
            game.ballY += game.ballVY;

            updateWindIndicator();

            // ÈÇäÁïåÁ¢∞Êíû
            // Â∑¶ÈÇäÁïå
            if (game.ballX - game.ballRadius < 0) {
                game.ballX = game.ballRadius;
                game.ballVX = -game.ballVX * game.bounceDamping;
            }
            // Âè≥ÈÇäÁïå
            if (game.ballX + game.ballRadius > gameAreaRect.width) {
                game.ballX = gameAreaRect.width - game.ballRadius;
                game.ballVX = -game.ballVX * game.bounceDamping;
            }
            // ‰∏äÈÇäÁïå
            if (game.ballY - game.ballRadius < 0) {
                game.ballY = game.ballRadius;
                game.ballVY = -game.ballVY * game.bounceDamping;
            }

            // ËÉåÊùøÁ¢∞Êíû
            checkBackboardCollision();

            // Ê™¢Êü•Á±ÉÊ°ÜÁ¢∞Êíû
            checkHoopCollision();

            // Â∫ïÈÉ®ÈÇäÁïå - ÈÅäÊà≤ÁµêÊùü
            if (game.ballY - game.ballRadius > gameAreaRect.height) {
                endThrow();
                return;
            }

            updateBallPosition();
            requestAnimationFrame(gameLoop);
        }

        // ËÉåÊùøÁ¢∞ÊíûÊ™¢Ê∏¨
        function checkBackboardCollision() {
            const ballRight = game.ballX + game.ballRadius;
            const ballLeft = game.ballX - game.ballRadius;
            const ballBottom = game.ballY + game.ballRadius;
            const ballTop = game.ballY - game.ballRadius;

            // Ê™¢Êü•ÁêÉÊòØÂê¶ËàáËÉåÊùøÁ¢∞Êíû
            if (ballRight > backboardPosition.x &&
                ballLeft < backboardPosition.x + backboardPosition.width &&
                ballBottom > backboardPosition.y &&
                ballTop < backboardPosition.y + backboardPosition.height) {

                // ÂæûÂè≥ÈÇäÁ¢∞Êíû
                if (game.ballVX > 0) {
                    game.ballX = backboardPosition.x - game.ballRadius;
                    game.ballVX = -game.ballVX * game.maxBounceDamping;
                }
                // Âæû‰∏ãÈÇäÁ¢∞Êíû
                if (game.ballVY > 0) {
                    game.ballY = backboardPosition.y + backboardPosition.height + game.ballRadius;
                    game.ballVY = -game.ballVY * game.maxBounceDamping;
                }
            }
        }

        // Á±ÉÊ°ÜÁ¢∞ÊíûÊ™¢Ê∏¨
        function checkHoopCollision() {
            const difficulty = difficulties[game.difficulty];
            const effectiveRadius = hoopPosition.radius * difficulty.holeSize;

            // Ë∑ùÈõ¢Á±ÉÊ°Ü‰∏≠ÂøÉ
            const dx = game.ballX - hoopPosition.x;
            const dy = game.ballY - hoopPosition.y;
            const distance = Math.sqrt(dx * dx + dy * dy);

            // ÈÄ≤ÁêÉÔºÅ
            if (distance < effectiveRadius && game.ballVY > 0) {
                game.score += 2;
                game.hits++;
                game.streak++;
                showMessage('ÈÄ≤ÁêÉÔºÅ üéâ', false);
                endThrow();
                return;
            }

            // Á¢∞Âà∞Á±ÉÊ°ÜÈÇäÁ∑£
            if (distance < hoopPosition.radius + game.ballRadius && distance > effectiveRadius) {
                // ÂèçÂΩà
                const angle = Math.atan2(dy, dx);
                const speed = Math.sqrt(game.ballVX ** 2 + game.ballVY ** 2);

                game.ballVX = Math.cos(angle) * speed * game.bounceDamping;
                game.ballVY = Math.sin(angle) * speed * game.bounceDamping;

                // ËºïÂæÆÊé®Èõ¢
                const pushDist = hoopPosition.radius + game.ballRadius - distance;
                game.ballX += Math.cos(angle) * pushDist;
                game.ballY += Math.sin(angle) * pushDist;
            }
        }

        // ÁµêÊùüÊäïÁ±É
        function endThrow() {
            game.isThrown = false;
            setTimeout(() => {
                if (game.hits === game.attempts) {
                    // ‰øùÊåÅÈÄ£Á∫åÂæóÂàÜ
                } else {
                    game.streak = 0;
                }
                updateUI();
            }, 500);
        }

        // Êõ¥Êñ∞ÁêÉ‰ΩçÁΩÆ
        function updateBallPosition() {
            elements.ball.style.left = game.ballX + 'px';
            elements.ball.style.top = game.ballY + 'px';
        }

        // Êõ¥Êñ∞UI
        function updateUI() {
            elements.score.textContent = game.score;
            elements.attempts.textContent = game.attempts;
            const accuracy = game.attempts > 0 ? Math.round((game.hits / game.attempts) * 100) : 0;
            elements.accuracy.textContent = accuracy + '%';
            elements.streak.textContent = game.streak;
        }

        // Êõ¥Êñ∞È¢®ÊåáÁ§∫
        function updateWindIndicator() {
            const windText = Math.abs(game.wind) < 0.2 ? 'ÁÑ°' :
                            game.wind > 0 ? '‚Üí ' + Math.round(Math.abs(game.wind) * 10) :
                            '‚Üê ' + Math.round(Math.abs(game.wind) * 10);
            elements.windIndicator.textContent = 'È¢®: ' + windText;
        }

        // È°ØÁ§∫Ê∂àÊÅØ
        function showMessage(text, isFail = false) {
            elements.message.textContent = text;
            elements.message.classList.toggle('fail', isFail);
            setTimeout(clearMessage, 2000);
        }

        // Ê∏ÖÈô§Ê∂àÊÅØ
        function clearMessage() {
            elements.message.textContent = '';
            elements.message.classList.remove('fail');
        }

        // ÈáçÊñ∞ÈñãÂßã
        function reset() {
            game.score = 0;
            game.attempts = 0;
            game.hits = 0;
            game.streak = 0;
            game.power = 0;
            game.ballX = 20;
            game.ballY = 50;
            game.ballVX = 0;
            game.ballVY = 0;
            game.isThrown = false;
            game.wind = 0;

            clearMessage();
            updateUI();
            updatePowerBar();
            updateBallPosition();
        }

        // ÂàùÂßãÂåñ
        updateUI();
        updateBallPosition();
    </script>
</body>
</html>
